{
  "models": [
    {
      "name": "User",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "uid", "type": "CharField(128)", "unique": true, "required": true},
        {"name": "role", "type": "CharField(20)", "choices": ["student", "teacher", "speaking_mentor", "admin", "curator"], "required": true},
        {"name": "student_id", "type": "CharField(64)", "nullable": true},
        {"name": "curator_id", "type": "CharField(64)", "nullable": true},
        {"name": "first_name", "type": "CharField(64)", "nullable": true},
        {"name": "last_name", "type": "CharField(64)", "nullable": true},
        {"name": "email", "type": "EmailField(255)", "unique": true, "nullable": true},
        {"name": "group", "type": "CharField(128)", "nullable": true},
        {"name": "teacher", "type": "CharField(128)", "nullable": true},
        {"name": "assigned_teacher_id", "type": "ForeignKey(User)", "nullable": true, "on_delete": "SET_NULL"},
        {"name": "is_staff", "type": "BooleanField", "default": false},
        {"name": "is_superuser", "type": "BooleanField", "default": false},
        {"name": "is_active", "type": "BooleanField", "default": true}
      ]
    },
    {
      "name": "WritingTest",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "title", "type": "CharField(255)"},
        {"name": "description", "type": "TextField", "nullable": true},
        {"name": "is_active", "type": "BooleanField", "default": false},
        {"name": "explanation_url", "type": "URLField", "nullable": true},
        {"name": "is_diagnostic_template", "type": "BooleanField", "default": false},
        {"name": "created_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "updated_at", "type": "DateTimeField", "auto_now": true}
      ]
    },
    {
      "name": "WritingTestSession",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "user_id", "type": "ForeignKey(User)", "on_delete": "CASCADE"},
        {"name": "test_id", "type": "ForeignKey(WritingTest)", "nullable": true, "on_delete": "CASCADE"},
        {"name": "started_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "completed", "type": "BooleanField", "default": false},
        {"name": "band_score", "type": "FloatField", "nullable": true},
        {"name": "is_diagnostic", "type": "BooleanField", "default": false}
      ]
    },
    {
      "name": "WritingTask",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "test_id", "type": "ForeignKey(WritingTest)", "on_delete": "CASCADE"},
        {"name": "task_type", "type": "CharField(10)", "choices": ["task1", "task2"]},
        {"name": "task_text", "type": "TextField"},
        {"name": "image", "type": "ImageField", "nullable": true},
        {"name": "created_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "updated_at", "type": "DateTimeField", "auto_now": true}
      ],
      "constraints": [
        {"type": "unique_together", "fields": ["test_id", "task_type"]}
      ]
    },
    {
      "name": "WritingPrompt",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "task_type", "type": "CharField(10)", "choices": ["task1", "task2"]},
        {"name": "prompt_text", "type": "TextField"},
        {"name": "created_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "image", "type": "ImageField", "nullable": true},
        {"name": "is_active", "type": "BooleanField", "default": false}
      ]
    },
    {
      "name": "Essay",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "user_id", "type": "ForeignKey(User)", "on_delete": "CASCADE"},
        {"name": "task_type", "type": "CharField(10)", "choices": ["task1", "task2"]},
        {"name": "question_text", "type": "TextField"},
        {"name": "submitted_text", "type": "TextField"},
        {"name": "score_task", "type": "FloatField", "nullable": true},
        {"name": "score_coherence", "type": "FloatField", "nullable": true},
        {"name": "score_lexical", "type": "FloatField", "nullable": true},
        {"name": "score_grammar", "type": "FloatField", "nullable": true},
        {"name": "overall_band", "type": "FloatField", "nullable": true},
        {"name": "feedback", "type": "TextField", "nullable": true},
        {"name": "submitted_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "test_session_id", "type": "ForeignKey(WritingTestSession)", "nullable": true, "on_delete": "CASCADE"},
        {"name": "task_id", "type": "ForeignKey(WritingTask)", "nullable": true, "on_delete": "SET_NULL"},
        {"name": "prompt_id", "type": "ForeignKey(WritingPrompt)", "nullable": true, "on_delete": "SET_NULL"}
      ]
    },
    {
      "name": "TeacherFeedback",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "essay_id", "type": "OneToOneField(Essay)", "on_delete": "CASCADE"},
        {"name": "teacher_id", "type": "ForeignKey(User)", "on_delete": "CASCADE"},
        {"name": "overall_feedback", "type": "TextField", "default": ""},
        {"name": "annotations", "type": "JSONField", "default": []},
        {"name": "teacher_task_score", "type": "FloatField", "nullable": true},
        {"name": "teacher_coherence_score", "type": "FloatField", "nullable": true},
        {"name": "teacher_lexical_score", "type": "FloatField", "nullable": true},
        {"name": "teacher_grammar_score", "type": "FloatField", "nullable": true},
        {"name": "teacher_overall_score", "type": "FloatField", "nullable": true},
        {"name": "teacher_task_feedback", "type": "TextField", "default": ""},
        {"name": "teacher_coherence_feedback", "type": "TextField", "default": ""},
        {"name": "teacher_lexical_feedback", "type": "TextField", "default": ""},
        {"name": "teacher_grammar_feedback", "type": "TextField", "default": ""},
        {"name": "published", "type": "BooleanField", "default": false},
        {"name": "created_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "updated_at", "type": "DateTimeField", "auto_now": true},
        {"name": "published_at", "type": "DateTimeField", "nullable": true}
      ]
    },
    {
      "name": "ListeningTest",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "title", "type": "CharField(255)"},
        {"name": "description", "type": "TextField", "nullable": true},
        {"name": "is_active", "type": "BooleanField", "default": false},
        {"name": "explanation_url", "type": "URLField", "nullable": true},
        {"name": "is_diagnostic_template", "type": "BooleanField", "default": false},
        {"name": "created_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "updated_at", "type": "DateTimeField", "auto_now": true}
      ]
    },
    {
      "name": "ListeningPart",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "test_id", "type": "ForeignKey(ListeningTest)", "on_delete": "CASCADE"},
        {"name": "part_number", "type": "PositiveIntegerField"},
        {"name": "audio", "type": "CharField(500)", "nullable": true},
        {"name": "audio_duration", "type": "FloatField", "default": 0},
        {"name": "instructions", "type": "TextField", "nullable": true},
        {"name": "created_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "updated_at", "type": "DateTimeField", "auto_now": true}
      ]
    },
    {
      "name": "ListeningQuestion",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "part_id", "type": "ForeignKey(ListeningPart)", "on_delete": "CASCADE"},
        {"name": "order", "type": "PositiveIntegerField"},
        {"name": "question_type", "type": "CharField(32)", "nullable": true},
        {"name": "question_text", "type": "TextField", "nullable": true},
        {"name": "task_prompt", "type": "TextField", "default": ""},
        {"name": "extra_data", "type": "JSONField", "default": {}},
        {"name": "correct_answers", "type": "JSONField", "default": []},
        {"name": "header", "type": "CharField(255)", "default": ""},
        {"name": "instruction", "type": "TextField", "default": ""},
        {"name": "image", "type": "CharField(500)", "nullable": true},
        {"name": "image_file", "type": "ImageField", "nullable": true},
        {"name": "points", "type": "PositiveIntegerField", "nullable": true},
        {"name": "scoring_mode", "type": "CharField(20)", "choices": ["total", "per_correct"], "default": "total"},
        {"name": "created_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "updated_at", "type": "DateTimeField", "auto_now": true}
      ]
    },
    {
      "name": "ListeningAnswerOption",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "question_id", "type": "ForeignKey(ListeningQuestion)", "on_delete": "CASCADE"},
        {"name": "label", "type": "CharField(8)"},
        {"name": "text", "type": "CharField(255)"},
        {"name": "points", "type": "PositiveIntegerField", "default": 1}
      ]
    },
    {
      "name": "ListeningTestSession",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "user_id", "type": "ForeignKey(User)", "on_delete": "CASCADE"},
        {"name": "test_id", "type": "ForeignKey(ListeningTest)", "on_delete": "CASCADE"},
        {"name": "started_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "completed_at", "type": "DateTimeField", "nullable": true},
        {"name": "timer_seconds", "type": "IntegerField", "default": 0},
        {"name": "audio_position", "type": "FloatField", "default": 0},
        {"name": "status", "type": "CharField(32)", "default": "in_progress"},
        {"name": "state", "type": "JSONField", "default": {}},
        {"name": "submitted", "type": "BooleanField", "default": false},
        {"name": "answers", "type": "JSONField", "default": {}},
        {"name": "flagged", "type": "JSONField", "default": {}},
        {"name": "time_left", "type": "IntegerField", "default": 2400},
        {"name": "score", "type": "FloatField", "nullable": true},
        {"name": "correct_answers_count", "type": "IntegerField", "default": 0},
        {"name": "total_questions_count", "type": "IntegerField", "default": 0},
        {"name": "is_diagnostic", "type": "BooleanField", "default": false}
      ]
    },
    {
      "name": "ListeningStudentAnswer",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "session_id", "type": "ForeignKey(ListeningTestSession)", "on_delete": "CASCADE"},
        {"name": "question_id", "type": "ForeignKey(ListeningQuestion)", "on_delete": "CASCADE"},
        {"name": "answer", "type": "TextField"},
        {"name": "flagged", "type": "BooleanField", "default": false},
        {"name": "submitted_at", "type": "DateTimeField", "auto_now_add": true}
      ]
    },
    {
      "name": "ListeningTestResult",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "session_id", "type": "OneToOneField(ListeningTestSession)", "on_delete": "CASCADE"},
        {"name": "raw_score", "type": "IntegerField", "default": 0},
        {"name": "band_score", "type": "FloatField", "default": 0},
        {"name": "breakdown", "type": "JSONField", "default": {}},
        {"name": "calculated_at", "type": "DateTimeField", "auto_now_add": true}
      ]
    },
    {
      "name": "ListeningTestClone",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "source_test_id", "type": "ForeignKey(ListeningTest)", "on_delete": "CASCADE"},
        {"name": "cloned_test_id", "type": "OneToOneField(ListeningTest)", "on_delete": "CASCADE"},
        {"name": "cloned_at", "type": "DateTimeField", "auto_now_add": true}
      ]
    },
    {
      "name": "ReadingTest",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "title", "type": "CharField(255)"},
        {"name": "description", "type": "TextField", "nullable": true},
        {"name": "time_limit", "type": "PositiveIntegerField", "default": 60},
        {"name": "total_points", "type": "PositiveIntegerField", "default": 0},
        {"name": "is_active", "type": "BooleanField", "default": false},
        {"name": "explanation_url", "type": "URLField", "nullable": true},
        {"name": "is_diagnostic_template", "type": "BooleanField", "default": false},
        {"name": "created_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "updated_at", "type": "DateTimeField", "auto_now": true}
      ]
    },
    {
      "name": "ReadingPart",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "test_id", "type": "ForeignKey(ReadingTest)", "on_delete": "CASCADE"},
        {"name": "part_number", "type": "PositiveIntegerField"},
        {"name": "title", "type": "CharField(255)", "default": ""},
        {"name": "instructions", "type": "TextField", "default": ""},
        {"name": "passage_text", "type": "TextField", "default": ""},
        {"name": "passage_heading", "type": "CharField(255)", "nullable": true},
        {"name": "passage_image_url", "type": "CharField(500)", "nullable": true},
        {"name": "order", "type": "PositiveIntegerField", "default": 1},
        {"name": "created_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "updated_at", "type": "DateTimeField", "auto_now": true}
      ]
    },
    {
      "name": "ReadingQuestion",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "part_id", "type": "ForeignKey(ReadingPart)", "on_delete": "CASCADE"},
        {"name": "order", "type": "PositiveIntegerField"},
        {"name": "question_type", "type": "CharField(32)", "nullable": true},
        {"name": "header", "type": "CharField(255)", "default": ""},
        {"name": "instruction", "type": "TextField", "default": ""},
        {"name": "task_prompt", "type": "TextField", "default": ""},
        {"name": "image_url", "type": "CharField(500)", "nullable": true},
        {"name": "image_file", "type": "ImageField", "nullable": true},
        {"name": "question_text", "type": "TextField", "nullable": true},
        {"name": "points", "type": "FloatField", "default": 1},
        {"name": "correct_answers", "type": "JSONField", "default": []},
        {"name": "extra_data", "type": "JSONField", "default": {}},
        {"name": "reading_scoring_type", "type": "CharField(20)", "choices": ["all_or_nothing", "per_correct_option"], "default": "all_or_nothing"},
        {"name": "created_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "updated_at", "type": "DateTimeField", "auto_now": true}
      ]
    },
    {
      "name": "ReadingAnswerOption",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "question_id", "type": "ForeignKey(ReadingQuestion)", "on_delete": "CASCADE"},
        {"name": "label", "type": "CharField(16)"},
        {"name": "text", "type": "TextField", "default": ""},
        {"name": "image_url", "type": "CharField(500)", "nullable": true},
        {"name": "is_correct", "type": "BooleanField", "default": false},
        {"name": "reading_points", "type": "PositiveIntegerField", "default": 1}
      ]
    },
    {
      "name": "ReadingTestSession",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "user_id", "type": "ForeignKey(User)", "on_delete": "CASCADE"},
        {"name": "test_id", "type": "ForeignKey(ReadingTest)", "on_delete": "CASCADE"},
        {"name": "start_time", "type": "DateTimeField", "auto_now_add": true},
        {"name": "end_time", "type": "DateTimeField", "nullable": true},
        {"name": "completed", "type": "BooleanField", "default": false},
        {"name": "answers", "type": "JSONField", "default": {}},
        {"name": "time_left_seconds", "type": "IntegerField", "default": 3600},
        {"name": "is_diagnostic", "type": "BooleanField", "default": false}
      ]
    },
    {
      "name": "ReadingTestResult",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "session_id", "type": "OneToOneField(ReadingTestSession)", "on_delete": "CASCADE"},
        {"name": "raw_score", "type": "FloatField", "default": 0},
        {"name": "total_score", "type": "FloatField", "default": 0},
        {"name": "band_score", "type": "FloatField", "default": 0},
        {"name": "breakdown", "type": "JSONField", "default": {}},
        {"name": "calculated_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "time_taken", "type": "DurationField", "nullable": true}
      ]
    },
    {
      "name": "TeacherSatisfactionSurvey",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "student_id", "type": "ForeignKey(User)", "on_delete": "CASCADE"},
        {"name": "is_satisfied", "type": "BooleanField"},
        {"name": "reason", "type": "TextField", "nullable": true},
        {"name": "submitted_at", "type": "DateTimeField", "auto_now_add": true}
      ],
      "constraints": [
        {"type": "unique_together", "fields": ["student_id", "submitted_at"]}
      ]
    },
    {
      "name": "SpeakingSession",
      "fields": [
        {"name": "id", "type": "AutoField", "role": "PK"},
        {"name": "student_id", "type": "ForeignKey(User)", "related_name": "speaking_sessions", "on_delete": "CASCADE"},
        {"name": "teacher_id", "type": "ForeignKey(User)", "related_name": "conducted_speaking_sessions", "on_delete": "CASCADE"},
        {"name": "fluency_coherence_score", "type": "FloatField", "nullable": true},
        {"name": "lexical_resource_score", "type": "FloatField", "nullable": true},
        {"name": "grammatical_range_score", "type": "FloatField", "nullable": true},
        {"name": "pronunciation_score", "type": "FloatField", "nullable": true},
        {"name": "overall_band_score", "type": "FloatField", "nullable": true},
        {"name": "fluency_coherence_feedback", "type": "TextField", "default": ""},
        {"name": "lexical_resource_feedback", "type": "TextField", "default": ""},
        {"name": "grammatical_range_feedback", "type": "TextField", "default": ""},
        {"name": "pronunciation_feedback", "type": "TextField", "default": ""},
        {"name": "overall_feedback", "type": "TextField", "default": ""},
        {"name": "duration_seconds", "type": "IntegerField", "nullable": true},
        {"name": "time_markers", "type": "JSONField", "default": []},
        {"name": "session_notes", "type": "TextField", "default": ""},
        {"name": "completed", "type": "BooleanField", "default": false},
        {"name": "conducted_at", "type": "DateTimeField", "auto_now_add": true},
        {"name": "updated_at", "type": "DateTimeField", "auto_now": true}
      ]
    }
  ]
}



